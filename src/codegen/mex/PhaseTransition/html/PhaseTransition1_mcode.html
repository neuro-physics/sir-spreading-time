<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">nAct</span>, <span class="var type1" id="S3T1U4">nAct2</span>, <span class="var type1" id="S4T2U5">stimIndex</span>, <span class="var type1" id="S5T2U6">nActVec</span> ] = PhaseTransition(<span class="var type1" id="S6T2U9">A</span>, <span class="var type1" id="S7T1U10">ThetaRange</span>, <span class="var type1" id="S8T3U11">nSim</span>, <span class="var type1" id="S9T3U12">tTotal</span>, <span class="var type1" id="S10T1U13">x0</span>, <span class="var type1" id="S11T4U14">icType</span>, <span class="var type1" id="S12T5U15">useWeightSampling</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% A -&gt; adjacency matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% ThetaRange -&gt; 1,nTheta vector containing the threshold values for the elements</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% nSim -&gt; number of simulations for each theta in ThetaRange</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% tTotal -&gt; max number of time steps used to try to activate entire network</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% x0 -&gt; 1,N vector containing the initial condition for each of the N nodes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% icType -&gt; 'fixed': the same node is stimulated for every theta and sim</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%           'mostconn': the same node (most connected) is stimulated for every theta and sim</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%           'random': randomly choose one seed node</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%           'allnodes': runs one simulation for each node</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% useWeightSampling -&gt; if true, a new weight sampling is generated for each simulation of each theta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% returns</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% nAct -&gt; number of activated sites for each theta in ThetaRange</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% nAct2 -&gt; variance of nAct</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">    coder.extrinsic(<span class="string">'rng'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">    coder.extrinsic(<span class="string">'FitMatrixWeights'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">    <span class="mxinfo " id="T6:U12"><span class="extrinsicFcn" id="F405N17:B30">rng</span>(<span class="mxinfo " id="T7:U13"><span class="string">'shuffle'</span></span>, <span class="mxinfo " id="T7:U14"><span class="string">'twister'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">    <span class="mxinfo " id="T5:U15"><span class="var type1" id="S15T5U35">isFixed</span> = <span class="mxinfo " id="T5:U17">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">    <span class="mxinfo " id="T5:U18"><span class="var type1" id="S17T5U40">mostConn</span> = <span class="mxinfo " id="T5:U20">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">    <span class="mxinfo " id="T5:U21"><span class="var type1" id="S18T5U45">isAllNodes</span> = <span class="mxinfo " id="T5:U23">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T5:U24">strcmpi(<span class="var type1" id="S11T4U52">icType</span>, <span class="string">'fixed'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">        <span class="mxinfo " id="T5:U26"><span class="var type1" id="S15T5U56">isFixed</span> = <span class="mxinfo " id="T5:U28">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">        <span class="mxinfo " id="T5:U29"><span class="var type1" id="S17T5U61">mostConn</span> = <span class="mxinfo " id="T5:U31">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">        <span class="mxinfo " id="T5:U32"><span class="var type1" id="S18T5U66">isAllNodes</span> = <span class="mxinfo " id="T5:U34">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">    <span class="keyword">if</span>  <span class="mxinfo " id="T5:U35">strcmpi(<span class="var type1" id="S11T4U73">icType</span>, <span class="string">'mostconn'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">        <span class="mxinfo " id="T5:U37"><span class="var type1" id="S15T5U77">isFixed</span> = <span class="mxinfo " id="T5:U39">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">        <span class="mxinfo " id="T5:U40"><span class="var type1" id="S17T5U82">mostConn</span> = <span class="mxinfo " id="T5:U42">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">        <span class="mxinfo " id="T5:U43"><span class="var type1" id="S18T5U87">isAllNodes</span> = <span class="mxinfo " id="T5:U45">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    <span class="keyword">if</span>  <span class="mxinfo " id="T5:U46">strcmpi(<span class="var type1" id="S11T4U94">icType</span>, <span class="string">'allnodes'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">        <span class="mxinfo " id="T5:U48"><span class="var type1" id="S15T5U98">isFixed</span> = <span class="mxinfo " id="T5:U50">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">        <span class="mxinfo " id="T5:U51"><span class="var type1" id="S17T5U103">mostConn</span> = <span class="mxinfo " id="T5:U53">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">        <span class="mxinfo " id="T5:U54"><span class="var type1" id="S18T5U108">isAllNodes</span> = <span class="mxinfo " id="T5:U56">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T5:U57">strcmpi(<span class="var type1" id="S11T4U115">icType</span>, <span class="string">'random'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">        <span class="mxinfo " id="T5:U59"><span class="var type1" id="S15T5U119">isFixed</span> = <span class="mxinfo " id="T5:U61">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T8:U62"><span class="var type1" id="S21T8U124">nodes</span> = <span class="mxinfo " id="T8:U64"><span class="fcn" id="F227N4:B126">GetNodes</span>(<span class="var type1" id="S6T2U127">A</span>, <span class="mxinfo " id="T3:U66"><span class="var type1" id="S7T1U129">ThetaRange</span>(<span class="mxinfo " id="T3:U68">1</span>)</span>, <span class="var type1" id="S10T1U131">x0</span>, <span class="mxinfo " id="T3:U70">1</span>, false)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T3:U71"><span class="var type1" id="S23T3U137">N</span> = <span class="mxinfo " id="T3:U73">numel(<span class="var type1" id="S21T8U140">nodes</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T1:U75"><span class="var type1" id="S2T1U143">nAct</span> = <span class="mxinfo " id="T1:U77">zeros(<span class="mxinfo " id="T3:U78">size(<span class="var type1" id="S7T1U148">ThetaRange</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T1:U80"><span class="var type1" id="S3T1U151">nAct2</span> = <span class="mxinfo " id="T1:U82">zeros(<span class="mxinfo " id="T3:U83">size(<span class="var type1" id="S7T1U156">ThetaRange</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T3:U85"><span class="var type1" id="S27T3U159">nTheta</span> = <span class="mxinfo " id="T3:U87">numel(<span class="var type1" id="S7T1U162">ThetaRange</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S15T5U165">isFixed</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">        <span class="keyword">if</span> <span class="var type1" id="S18T5U168">isAllNodes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">            <span class="mxinfo " id="T2:U91"><span class="var type1" id="S4T2U171">stimIndex</span> = <span class="mxinfo " id="T2:U93">repmat(<span class="mxinfo " id="T1:U94">1:<span class="var type1" id="S23T3U176">N</span></span>, <span class="var type1" id="S27T3U177">nTheta</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">            <span class="mxinfo " id="T3:U97"><span class="var type1" id="S8T3U181">nSim</span> = <span class="var type1" id="S23T3U182">N</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">            <span class="keyword">if</span> <span class="var type1" id="S17T5U186">mostConn</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">                <span class="potentialdiff PD7"><span class="potentialdiff PD8">[ <span class="mxinfo " id="T3:U101">~</span>, <span class="var type1" id="S29T3U191">ind</span> ] = max(<span class="mxinfo " id="T1:U103"><span class="potentialdiff PD4"><span class="potentialdiff PD7">sum(<span class="mxinfo " id="T11:U104"><span class="var type1" id="S6T2U197">A</span>~=<span class="mxinfo " id="T3:U106">0</span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">                <span class="mxinfo " id="T3:U107"><span class="var type1" id="S32T3U201">stInd</span> = <span class="var type1" id="S29T3U202">ind</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">                <span class="mxinfo " id="T3:U110"><span class="var type1" id="S32T3U206">stInd</span> = <span class="mxinfo " id="T3:U112">randi(<span class="mxinfo " id="T3:U113">numel(<span class="var type1" id="S10T1U211">x0</span>)</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">            <span class="mxinfo " id="T2:U115"><span class="var type1" id="S4T2U215">stimIndex</span> = <span class="mxinfo " id="T2:U117">repmat(<span class="var type1" id="S32T3U218">stInd</span>, <span class="var type1" id="S27T3U219">nTheta</span>, <span class="var type1" id="S8T3U220">nSim</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">        <span class="mxinfo " id="T2:U121"><span class="var type1" id="S4T2U224">stimIndex</span> = <span class="mxinfo " id="T2:U123">randi(<span class="mxinfo " id="T3:U124">numel(<span class="var type1" id="S10T1U229">x0</span>)</span>, <span class="var type1" id="S27T3U230">nTheta</span>, <span class="var type1" id="S8T3U231">nSim</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="mxinfo " id="T2:U128"><span class="var type1" id="S5T2U234">nActVec</span> = <span class="mxinfo " id="T2:U130">zeros(<span class="var type1" id="S27T3U237">nTheta</span>,<span class="mxinfo " id="T3:U132"><span class="var type1" id="S8T3U238"><span class="potentialdiff PD5">nSim</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T3:U133"><span class="var type1" id="S34T3U241">mu</span> = <span class="mxinfo " id="T3:U135">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    <span class="mxinfo " id="T3:U136"><span class="var type1" id="S35T3U245">sigma</span> = <span class="mxinfo " id="T3:U138">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S12T5U249">useWeightSampling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">        [<span class="var type1" id="S34T3U253">mu</span>, <span class="var type1" id="S35T3U254">sigma</span>] = <span class="extrinsicFcn" id="F417N3:B256">FitMatrixWeights</span>(<span class="var type1" id="S6T2U257">A</span>, <span class="mxinfo " id="T3:U143">100</span>, <span class="mxinfo " id="T5:U144">false</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S37T3U263">i</span> = <span class="mxinfo " id="T3:U146">1</span>:<span class="var type1" id="S27T3U266">nTheta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo " id="T3:U148"><span class="var type1" id="S38T3U269">nActSum</span> = <span class="mxinfo " id="T3:U150">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">        <span class="mxinfo " id="T3:U151"><span class="var type1" id="S39T3U273">nAct2Sum</span> = <span class="mxinfo " id="T3:U153">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S40T3U277">k</span> = <span class="potentialdiff PD1"><span class="mxinfo " id="T3:U155">1</span>:<span class="var type1" id="S8T3U280">nSim</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">            <span class="mxinfo " id="T1:U157"><span class="var type1" id="S41T1U283">x0i</span> = <span class="var type1" id="S10T1U284">x0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">            <span class="mxinfo " id="T3:U160"><span class="mxinfo " id="T3:U161"><span class="potentialdiff PD3"><span class="potentialdiff PD5"><span class="var type1" id="S41T1U288">x0i</span>(<span class="mxinfo " id="T3:U163"><span class="var type1" id="S4T2U290">stimIndex</span>(<span class="var type1" id="S37T3U291">i</span>,<span class="var type1" id="S40T3U292">k</span>)</span>)</span></span></span> = <span class="mxinfo " id="T3:U167">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">            <span class="keyword">if</span> <span class="var type1" id="S12T5U296">useWeightSampling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">                <span class="mxinfo " id="T2:U169"><span class="var type1" id="S42T2U299">Asurr</span> = <span class="mxinfo " id="T2:U171">zeros(<span class="mxinfo " id="T3:U172">size(<span class="var type1" id="S6T2U304">A</span>)</span>)</span></span>; <span class="comment">% avoids "Subscripting into an mxArray is not supported" error https://www.mathworks.com/matlabcentral/answers/122167-subscripting-into-an-mxarray-is-not-supported</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">                <span class="mxinfo " id="T2:U174"><span class="var type1" id="S42T2U307">Asurr</span> = <span class="mxinfo " id="T2:U176"><span class="fcn" id="F399N6:B309">GetSurrogateRandomMatrix</span>(<span class="var type1" id="S6T2U310">A</span>, <span class="var type1" id="S34T3U311">mu</span>, <span class="var type1" id="S35T3U312">sigma</span>, false)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">                <span class="mxinfo " id="T8:U180"><span class="var type1" id="S21T8U317">nodes</span> = <span class="mxinfo " id="T8:U182"><span class="fcn" id="F227N4:B319">GetNodes</span>(<span class="var type1" id="S42T2U320">Asurr</span>, <span class="mxinfo " id="T3:U184"><span class="var type1" id="S7T1U322">ThetaRange</span>(<span class="var type1" id="S37T3U323">i</span>)</span>, <span class="var type1" id="S41T1U324">x0i</span>, <span class="mxinfo " id="T3:U188">1</span>, false)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">                <span class="mxinfo " id="T8:U189"><span class="var type1" id="S21T8U331">nodes</span> = <span class="mxinfo " id="T8:U191"><span class="fcn" id="F400N8:B333">ResetNodes</span>(<span class="var type1" id="S21T8U334">nodes</span>, <span class="mxinfo " id="T3:U193"><span class="var type1" id="S7T1U336">ThetaRange</span>(<span class="var type1" id="S37T3U337">i</span>)</span>, <span class="var type1" id="S41T1U338">x0i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">            <span class="mxinfo " id="T3:U197"><span class="var type1" id="S45T3U341">nActTemp</span> = <span class="mxinfo " id="T3:U199"><span class="fcn" id="F404N2:B343">EvolveSINetworkAndCountActive</span>(<span class="var type1" id="S21T8U344">nodes</span>, <span class="var type1" id="S9T3U345">tTotal</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">            <span class="mxinfo " id="T3:U202"><span class="mxinfo " id="T3:U203"><span class="potentialdiff PD3"><span class="var type1" id="S5T2U349">nActVec</span>(<span class="var type1" id="S37T3U350">i</span>,<span class="var type1" id="S40T3U351">k</span>)</span></span> = <span class="var type1" id="S45T3U352">nActTemp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">            <span class="mxinfo " id="T3:U208"><span class="var type1" id="S38T3U355">nActSum</span> = <span class="mxinfo " id="T3:U210"><span class="var type1" id="S38T3U357">nActSum</span> + <span class="var type1" id="S45T3U358">nActTemp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">            <span class="mxinfo " id="T3:U213"><span class="var type1" id="S39T3U361">nAct2Sum</span> = <span class="mxinfo " id="T3:U215"><span class="var type1" id="S39T3U363">nAct2Sum</span> + <span class="mxinfo " id="T3:U217"><span class="var type1" id="S45T3U365">nActTemp</span> .* <span class="var type1" id="S45T3U366">nActTemp</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">        <span class="mxinfo " id="T3:U220"><span class="mxinfo " id="T3:U221"><span class="potentialdiff PD3"><span class="var type1" id="S2T1U370">nAct</span>(<span class="var type1" id="S37T3U371">i</span>)</span></span> = <span class="mxinfo " id="T3:U224"><span class="var type1" id="S38T3U373">nActSum</span> ./ <span class="var type1" id="S8T3U374">nSim</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo " id="T3:U227"><span class="mxinfo " id="T3:U228"><span class="potentialdiff PD3"><span class="var type1" id="S3T1U378">nAct2</span>(<span class="var type1" id="S37T3U379">i</span>)</span></span> = <span class="mxinfo " id="T3:U231"><span class="mxinfo " id="T3:U232"><span class="var type1" id="S39T3U382">nAct2Sum</span> ./ <span class="var type1" id="S8T3U383">nSim</span></span> - <span class="mxinfo " id="T3:U235"><span class="mxinfo " id="T3:U236"><span class="var type1" id="S2T1U386">nAct</span>(<span class="var type1" id="S37T3U387">i</span>)</span> .* <span class="mxinfo " id="T3:U239"><span class="var type1" id="S2T1U389">nAct</span>(<span class="var type1" id="S37T3U390">i</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">%         if rho2(i) &lt; 0.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%             rho2(i) = 0.0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="comment">% function nn = EvolveSINetworkAndCountActive(nodes, tTotal)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">%     N = numel(nodes);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="comment">%     for t = 1:tTotal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="comment">%         for i = 1:N</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="comment">%             nodes(i).par.Isyn = UpdateInput(i, nodes);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="comment">%         isNetActive = nodes(1).x &gt; 0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="comment">%         for i = 1:N</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="comment">%             nodes(i).x = SIElementIter(nodes(i).x, nodes(i).par);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="comment">%             isNetActive = isNetActive &amp;&amp; (nodes(i).x &gt; 0);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="comment">%         if isNetActive</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="comment">%             break;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"><span class="comment">%     nn = 0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="comment">%     for i = 1:N</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="comment">%         if nodes(i).x &gt; 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="comment">%             nn = nn + 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="comment">% end</span></span></span>
</pre>
</body>
</html>

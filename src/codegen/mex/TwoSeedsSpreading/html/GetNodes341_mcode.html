<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="75,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T10U3">nodes</span> = GetNodes(<span class="var type1" id="S3T1U6">A</span>,<span class="var type1" id="S4T4U7">Theta</span>,<span class="var type2" id="S5T4V1U8">x0</span>,<span class="var type1" id="S6T4U9">nSeeds</span>,<span class="var type1" id="S7T4U10">isCompetitive</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="75,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% A       -&gt; [N,N] adjacency matrix (either weighted or binary)</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% Theta   -&gt; [1,1] to [1,N] vector activation threshold; if a vector is provided, each element has Theta(i) activation Threshold</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% x0      -&gt; [1,1] to [1,N] initial condition; if a vector is provided, each element has ic x0(i)</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,5" id="srcline5"> 5</a></span><span class="line">    <span class="keyword">if</span> nargin &lt; 4 || isempty(<span class="var type1" id="S6T4U20">nSeeds</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="75,6" id="srcline6"> 6</a></span><span class="line">        <span class="var type0" id="S6T0U23">nSeeds</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="75,7" id="srcline7"> 7</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,8" id="srcline8"> 8</a></span><span class="line">    <span class="keyword">if</span> nargin &lt; 5 || isempty(<span class="var type1" id="S7T4U34">isCompetitive</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="75,9" id="srcline9"> 9</a></span><span class="line">        <span class="var type0" id="S7T0U37">isCompetitive</span> = false;</span></span>
<span class="srcline"><span class="lineno"><a href="75,10" id="srcline10">10</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T15:U9">~<span class="var type1" id="S7T4U43">isCompetitive</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="75,12" id="srcline12">12</a></span><span class="line">        <span class="mxinfo " id="T4:U11"><span class="var type1" id="S6T4U46">nSeeds</span> = <span class="mxinfo " id="T4:U13">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T4:U14"><span class="var type1" id="S11T4U50">N</span> = <span class="mxinfo " id="T4:U16">numel(<span class="mxinfo " id="T5:U17"><span class="var type1" id="S3T1U54">A</span>(<span class="mxinfo " id="T4:U19">1</span>,<span class="mxinfo " id="T12:U20">:</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T5:U21"><span class="var type1" id="S13T5U59">x_init</span> = <span class="mxinfo " id="T5:U23"><span class="fcn" id="F271N28:B61">repeatToComplete</span>(<span class="var type1" id="S5T4U62">x0</span>, <span class="var type1" id="S11T4U63">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T5:U26"><span class="var type1" id="S15T5U66">Theta_el</span> = <span class="mxinfo " id="T5:U28"><span class="fcn" id="F273N28:B68">repeatToComplete</span>(<span class="var type1" id="S4T4U69">Theta</span>, <span class="var type1" id="S11T4U70">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T10:U31"><span class="var type1" id="S2T10U73">nodes</span> = <span class="mxinfo " id="T62:U33">repmat(struct(<span class="string">'x'</span>, 0.0, <span class="string">'neigh'</span>, zeros(<span class="mxinfo " id="T4:U34">0</span>,1), <span class="string">'w'</span>, zeros(<span class="mxinfo " id="T4:U35">0</span>,1), <span class="string">'par'</span>, <span class="fcn" id="F274N7:B92">getParStruct</span>(0.0, 0.0, 0, 0.0, 0, 0, 0, 0.0)), 1, <span class="var type1" id="S11T4U102">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,18" id="srcline18">18</a></span><span class="line">    coder.varsize(<span class="string">'nodes(:).neigh'</span>, <span class="string">'nodes(:).w'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="75,19" id="srcline19">19</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T4U112">j</span> = <span class="mxinfo " id="T4:U38">1</span>:<span class="var type1" id="S11T4U115">N</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,20" id="srcline20">20</a></span><span class="line">        <span class="mxinfo " id="T2:U40"><span class="var type1" id="S22T2U118">ind</span> = <span class="mxinfo " id="T2:U42"><span class="potentialdiff PD6">find(<span class="mxinfo " id="T2:U43"><span class="var type1" id="S3T1U122">A</span>(<span class="mxinfo " id="T12:U45">:</span>,<span class="var type1" id="S21T4U124">j</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,21" id="srcline21">21</a></span><span class="line">        [<span class="mxinfo " id="T2:U47">~</span>,<span class="var type1" id="S24T2U129">s</span>] = sort(<span class="mxinfo " id="T2:U49"><span class="var type1" id="S3T1U133">A</span>(<span class="var type1" id="S22T2U134">ind</span>,<span class="var type1" id="S21T4U135">j</span>)</span>,<span class="string">'descend'</span>); <span class="comment">% sorting connections from the heaviest to the lightest</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,22" id="srcline22">22</a></span><span class="line">        <span class="mxinfo " id="T4:U53"><span class="mxinfo " id="T4:U54"><span class="mxinfo " id="T75:U55"><span class="potentialdiff PD3"><span class="var type1" id="S2T10U141">nodes</span>(<span class="var type1" id="S21T4U142">j</span>)</span></span>.x</span> = <span class="mxinfo " id="T4:U58"><span class="var type1" id="S13T5U145">x_init</span>(<span class="var type1" id="S21T4U146">j</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,23" id="srcline23">23</a></span><span class="line">        <span class="mxinfo " id="T2:U61"><span class="potentialdiff PD3"><span class="mxinfo " id="T2:U62"><span class="potentialdiff PD3"><span class="mxinfo " id="T75:U63"><span class="var type1" id="S2T10U151">nodes</span>(<span class="var type1" id="S21T4U152">j</span>)</span>.neigh</span></span> = <span class="mxinfo " id="T2:U66"><span class="var type1" id="S22T2U155">ind</span>(<span class="var type1" id="S24T2U156">s</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,24" id="srcline24">24</a></span><span class="line">        <span class="mxinfo " id="T2:U69"><span class="potentialdiff PD3"><span class="mxinfo " id="T2:U70"><span class="potentialdiff PD3"><span class="mxinfo " id="T75:U71"><span class="var type1" id="S2T10U161">nodes</span>(<span class="var type1" id="S21T4U162">j</span>)</span>.w</span></span> = <span class="mxinfo " id="T2:U74"><span class="var type1" id="S3T1U165">A</span>(<span class="mxinfo " id="T2:U76"><span class="var type1" id="S22T2U167">ind</span>(<span class="var type1" id="S24T2U168">s</span>)</span>,<span class="var type1" id="S21T4U169">j</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,25" id="srcline25">25</a></span><span class="line">        <span class="mxinfo " id="T11:U80"><span class="mxinfo " id="T11:U81"><span class="mxinfo " id="T75:U82"><span class="potentialdiff PD3"><span class="var type1" id="S2T10U174">nodes</span>(<span class="var type1" id="S21T4U175">j</span>)</span></span>.par</span> = <span class="mxinfo " id="T11:U85"><span class="fcn" id="F274N7:B178">getParStruct</span>(<span class="mxinfo " id="T4:U86">0.0</span>, <span class="mxinfo " id="T4:U87">0.0</span>, <span class="mxinfo " id="T4:U88">0</span>, <span class="mxinfo " id="T4:U89"><span class="var type1" id="S15T5U183">Theta_el</span>(<span class="var type1" id="S21T4U184">j</span>)</span>, <span class="mxinfo " id="T4:U92"><span class="potentialdiff PD7">sum(<span class="mxinfo " id="T2:U93"><span class="var type1" id="S3T1U188">A</span>(<span class="var type1" id="S22T2U189">ind</span>,<span class="var type1" id="S21T4U190">j</span>)</span>)</span></span>, <span class="mxinfo " id="T4:U97">numel(<span class="var type1" id="S22T2U193">ind</span>)</span>, <span class="var type1" id="S6T4U194">nSeeds</span>, <span class="mxinfo " id="T4:U100">0.0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="75,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,27" id="srcline27">27</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,28" id="srcline28">28</a></span><span class="line"></span></span>
</pre>
<div class="dead">
<pre class="code">
<span class="srcline"><span class="lineno"><a href="75,29" id="srcline29">29</a></span><span class="line">function p = getParStruct(Iext, Isyn, kInp, Theta, W, n, nInp, s)</span></span>
<span class="srcline"><span class="lineno"><a href="75,30" id="srcline30">30</a></span><span class="line"><span class="comment">% Iext -&gt; external current used to initially excite a given node</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,31" id="srcline31">31</a></span><span class="line"><span class="comment">% Isyn -&gt; sum of weighted inputs over node i; i.e. sum of w_ij * s_j</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,32" id="srcline32">32</a></span><span class="line"><span class="comment">% kInp -&gt; (only for multiple seeds) the state towards which node i must be updated (can be from 1 to nInp)</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,33" id="srcline33">33</a></span><span class="line"><span class="comment">% Theta -&gt; the element threshold for firing</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,34" id="srcline34">34</a></span><span class="line"><span class="comment">% W -&gt; total input weight over node i</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,35" id="srcline35">35</a></span><span class="line"><span class="comment">% n -&gt; number of inputs over node i</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,36" id="srcline36">36</a></span><span class="line"><span class="comment">% nInp -&gt; total number of possible states</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,37" id="srcline37">37</a></span><span class="line"><span class="comment">% s -&gt; cumulative time it took for node i to get activated during spreading time simulation (summing up all times from the initial seed stimulation)</span></span></span>
<span class="srcline"><span class="lineno"><a href="75,38" id="srcline38">38</a></span><span class="line">    p = struct('Iext', Iext, 'Isyn', Isyn, 'kInp', kInp, 'Theta', Theta, 'W', W, 'n', n, 'nInp', nInp, 'spTime', s);</span></span>
<span class="srcline"><span class="lineno"><a href="75,39" id="srcline39">39</a></span><span class="line">end</span></span>
<span class="srcline"><span class="lineno"><a href="75,40" id="srcline40">40</a></span><span class="line"> </span></span>
</pre>
</div>
</body>
</html>

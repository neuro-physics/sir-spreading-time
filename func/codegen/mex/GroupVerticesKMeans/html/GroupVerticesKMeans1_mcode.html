<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">%function groups = GroupVerticesKMeans(r, centers)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">clusterNumbers</span> = GroupVerticesKMeans(<span class="var type1" id="S3T2U6">r</span>, <span class="var type1" id="S4T2U7">centers</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% returns groups of arbitrary number of elements from the position, r, of N elements in the network</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% utilizes kmeans to produce the groups, so the number of elements in each group is random, but is around n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% each row of r is a position (3D or 2D)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    coder.extrinsic(<span class="string">'perms'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo " id="T3:U4"><span class="var type1" id="S6T3U16">sr</span> = <span class="mxinfo " id="T3:U6">size(<span class="var type1" id="S3T2U19">r</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo " id="T3:U8"><span class="var type1" id="S8T3U22">sc</span> = <span class="mxinfo " id="T3:U10">size(<span class="var type1" id="S4T2U25">centers</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T4:U12"><span class="var type1" id="S9T4U28">pm</span> = <span class="mxinfo " id="T4:U14">zeros(<span class="mxinfo " id="T5:U15">numel(<span class="var type1" id="S6T3U33">sr</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T4:U17"><span class="var type1" id="S9T4U36">pm</span> = <span class="mxinfo " id="T6:U19"><span class="extrinsicFcn" id="F523N5:B38">perms</span>(<span class="var type1" id="S6T3U39">sr</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo " id="T7:U21"><span class="var type1" id="S13T7U42">k</span> = <span class="mxinfo " id="T7:U23">find(<span class="mxinfo " id="T8:U24"><span class="var type1" id="S9T4U46">pm</span> == <span class="mxinfo " id="T4:U26">repmat(<span class="var type1" id="S8T3U49">sc</span>,[size(<span class="var type1" id="S9T4U54">pm</span>,1),1])</span></span>)</span></span>;<span class="mxinfo " id="T5:U29"><span class="var type1" id="S13T5U59">k</span>=<span class="mxinfo " id="T5:U31"><span class="var type1" id="S13T7U61">k</span>(<span class="mxinfo " id="T5:U33">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T9:U34"><span class="var type1" id="S16T9U65">n</span> = <span class="mxinfo " id="T9:U36">find(<span class="mxinfo " id="T10:U37"><span class="var type1" id="S6T3U69">sr</span>~=<span class="mxinfo " id="T5:U39"><span class="var type1" id="S9T4U71">pm</span>(<span class="var type1" id="S13T5U72">k</span>)</span></span>)</span></span>;<span class="mxinfo " id="T5:U42"><span class="var type1" id="S16T5U75">n</span>=<span class="mxinfo " id="T5:U44"><span class="var type1" id="S16T9U77">n</span>(<span class="mxinfo " id="T5:U46">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo " id="T5:U47"><span class="var type1" id="S17T5U81">sr1</span> = <span class="mxinfo " id="T5:U49"><span class="var type1" id="S6T3U83">sr</span>(<span class="var type1" id="S16T5U84">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T9:U52"><span class="var type1" id="S16T9U87">n</span> = <span class="mxinfo " id="T9:U54">find(<span class="mxinfo " id="T10:U55"><span class="var type1" id="S8T3U91">sc</span>~=<span class="mxinfo " id="T5:U57"><span class="var type1" id="S9T4U93">pm</span>(<span class="var type1" id="S13T5U94">k</span>)</span></span>)</span></span>;<span class="mxinfo " id="T5:U60"><span class="var type1" id="S16T5U97">n</span>=<span class="mxinfo " id="T5:U62"><span class="var type1" id="S16T9U99">n</span>(<span class="mxinfo " id="T5:U64">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T5:U65"><span class="var type1" id="S18T5U103">sc1</span> = <span class="mxinfo " id="T5:U67"><span class="var type1" id="S8T3U105">sc</span>(<span class="var type1" id="S16T5U106">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T11:U70"><span class="var type1" id="S3T11U109">r</span> = <span class="mxinfo " id="T11:U72">reshape(<span class="var type1" id="S3T2U112">r</span>,<span class="mxinfo " id="T3:U74">[<span class="var type1" id="S17T5U115">sr1</span>,<span class="mxinfo " id="T5:U76"><span class="var type1" id="S9T4U117">pm</span>(<span class="var type1" id="S13T5U118">k</span>)</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T11:U79"><span class="var type1" id="S4T11U121">centers</span> = <span class="mxinfo " id="T11:U81">reshape(<span class="var type1" id="S4T2U124">centers</span>,<span class="mxinfo " id="T3:U83">[<span class="var type1" id="S18T5U127">sc1</span>,<span class="mxinfo " id="T5:U85"><span class="var type1" id="S9T4U129">pm</span>(<span class="var type1" id="S13T5U130">k</span>)</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T5:U88"><span class="var type1" id="S20T5U133">nGroups</span> = <span class="mxinfo " id="T5:U90">size(<span class="var type1" id="S4T11U136">centers</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T1:U92"><span class="var type1" id="S2T1U140">clusterNumbers</span> = <span class="mxinfo " id="T1:U94">kmeans(<span class="var type1" id="S3T11U143">r</span>, <span class="var type1" id="S20T5U144">nGroups</span>, <span class="string">'start'</span>, <span class="var type1" id="S4T11U146">centers</span>, <span class="string">'onlinephase'</span>, <span class="string">'on'</span>, <span class="string">'distance'</span>, <span class="string">'sqEuclidean'</span>, <span class="string">'emptyaction'</span>, <span class="string">'singleton'</span>, <span class="string">'Options'</span>, statset(<span class="string">'MaxIter'</span>, 1000, <span class="string">'Display'</span>, <span class="string">'off'</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="comment">%     groups = cell(1,nGroups);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="comment">%     for i = 1:nGroups</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">%         groups{i} = find(clusterNumbers == i);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
